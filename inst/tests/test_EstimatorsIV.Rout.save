
R version 4.5.1 (2025-06-13 ucrt) -- "Great Square Root"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ## Replicate some IV regression results
> ## Replicate Baltagi (2013), Econometric Analysis of Panel Data, 5th edition, ch. 7.2 (p. 133)
> ## (same as Baltagi (2006), Estimating an econometric model of crime using panel data from North Carolina,
> ##                          Journal of Applied Econometrics 21(4), pp. 543-547.
> ##
> ## NB: Crime data set: results can diverge slightly form the values printed in Baltagi
> ##     if logarithm computation is performed on the original variable. For the paper,
> ##     a data set with pre-computed logarithms (variables l*) was used and those 
> ##     logarithmic values diverge from what R's log() function gives.
> ##     -> see the two FE2SLS example which is computed in both ways
> 
> 
> library(plm)
> data("Crime", package = "plm")
> 
> # replicates Table 7.1, column "Between"
> form <- log(crmrte) ~ log(prbarr) + log(prbconv) + log(prbpris) + log(avgsen) + log(polpc) + log(density) + log(wcon) + log(wtuc) + log(wtrd) + log(wfir) + log(wser) + log(wmfg) + log(wfed) + log(wsta) + log(wloc) + log(pctymle) + log(pctmin) + region + smsa
> be <- plm(form, data = Crime, model = "between")
> summary(be)
Oneway (individual) effect Between Model

Call:
plm(formula = form, data = Crime, model = "between")

Balanced Panel: n = 90, T = 7, N = 630
Observations used in estimation: 90

Residuals:
     Min.   1st Qu.    Median   3rd Qu.      Max. 
-0.510397 -0.098495 -0.021638  0.131446  0.598675 

Coefficients:
               Estimate Std. Error t-value  Pr(>|t|)    
(Intercept)   -2.096704   2.821910 -0.7430  0.459999    
log(prbarr)   -0.647509   0.087766 -7.3777 2.738e-10 ***
log(prbconv)  -0.528202   0.066741 -7.9143 2.868e-11 ***
log(prbpris)   0.296505   0.230668  1.2854  0.202943    
log(avgsen)   -0.235885   0.173534 -1.3593  0.178477    
log(polpc)     0.364217   0.060091  6.0611 6.370e-08 ***
log(density)   0.168390   0.077380  2.1761  0.032971 *  
log(wcon)      0.195005   0.210406  0.9268  0.357259    
log(wtuc)     -0.195747   0.170486 -1.1482  0.254864    
log(wtrd)      0.128619   0.278350  0.4621  0.645479    
log(wfir)      0.113239   0.220473  0.5136  0.609159    
log(wser)     -0.105834   0.162825 -0.6500  0.517861    
log(wmfg)     -0.024885   0.133876 -0.1859  0.853082    
log(wfed)      0.156213   0.287071  0.5442  0.588083    
log(wsta)     -0.283780   0.256342 -1.1070  0.272123    
log(wloc)      0.010325   0.463487  0.0223  0.982292    
log(pctymle)  -0.095049   0.157683 -0.6028  0.548626    
log(pctmin)    0.148195   0.048543  3.0529  0.003218 ** 
regionwest    -0.229630   0.108468 -2.1170  0.037865 *  
regioncentral -0.163672   0.064453 -2.5394  0.013362 *  
smsayes       -0.034592   0.132374 -0.2613  0.794624    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    26.913
Residual Sum of Squares: 3.2171
R-Squared:      0.88046
Adj. R-Squared: 0.84582
F-statistic: 25.4115 on 20 and 69 DF, p-value: < 2.22e-16
> 
> # replicates Table 7.1, column "Fixed Effects"
> fe <- plm(form, data = Crime, model = "within", effect = "twoways")
> summary(fe)
Twoways effects Within Model

Call:
plm(formula = form, data = Crime, effect = "twoways", model = "within")

Balanced Panel: n = 90, T = 7, N = 630

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-0.5581590 -0.0650155 -0.0018256  0.0698165  0.5247036 

Coefficients:
               Estimate Std. Error  t-value  Pr(>|t|)    
log(prbarr)  -0.3548257  0.0322048 -11.0178 < 2.2e-16 ***
log(prbconv) -0.2815673  0.0211376 -13.3207 < 2.2e-16 ***
log(prbpris) -0.1731044  0.0323027  -5.3588 1.263e-07 ***
log(avgsen)  -0.0024524  0.0261190  -0.0939  0.925232    
log(polpc)    0.4131576  0.0266231  15.5188 < 2.2e-16 ***
log(density)  0.4143782  0.2825417   1.4666  0.143089    
log(wcon)    -0.0377894  0.0390757  -0.9671  0.333954    
log(wtuc)     0.0455237  0.0190116   2.3945  0.016996 *  
log(wtrd)    -0.0205048  0.0404790  -0.5066  0.612682    
log(wfir)    -0.0038988  0.0282572  -0.1380  0.890312    
log(wser)     0.0088773  0.0191314   0.4640  0.642833    
log(wmfg)    -0.3598306  0.1118355  -3.2175  0.001374 ** 
log(wfed)    -0.3093206  0.1761644  -1.7559  0.079703 .  
log(wsta)     0.0528862  0.1135307   0.4658  0.641532    
log(wloc)     0.1815859  0.1176542   1.5434  0.123348    
log(pctymle)  0.6267986  0.3636065   1.7238  0.085334 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    16.123
Residual Sum of Squares: 9.6545
R-Squared:      0.40121
Adj. R-Squared: 0.2729
F-statistic: 21.6923 on 16 and 518 DF, p-value: < 2.22e-16
> 
> # replicates Table 7.1, column "FE2SLS"
> form_iv <- log(crmrte) ~ log(prbarr) + log(prbconv) + log(prbpris) + log(avgsen) + log(polpc) + log(density) + log(wcon) + log(wtuc) + log(wtrd) + log(wfir) + log(wser) + log(wmfg) + log(wfed) + log(wsta) + log(wloc) + log(pctymle) + log(pctmin) + region + smsa | . -log(prbarr) - log(polpc) + log(taxpc) + log(mix)
> form_iv2 <- lcrmrte ~ lprbarr + lprbconv + lprbpris + lavgsen + lpolpc + ldensity + lwcon + lwtuc + lwtrd + lwfir + lwser + lwmfg + lwfed + lwsta + lwloc + lpctymle + lpctmin + region + smsa | . -lprbarr - lpolpc + ltaxpc + lmix
> fe_iv <- plm(form_iv, data = Crime, model = "within", effect = "twoways", inst.method = "baltagi")
> fe_iv2 <- plm(form_iv2, data = Crime, model = "within", effect = "twoways", inst.method = "baltagi")
> summary(fe_iv)  # logs computed by R
Twoways effects Within Model
Instrumental variable estimation

Call:
plm(formula = form_iv, data = Crime, effect = "twoways", model = "within", 
    inst.method = "baltagi")

Balanced Panel: n = 90, T = 7, N = 630

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-0.7207996 -0.0682050 -0.0041004  0.0759313  0.5661408 

Coefficients:
               Estimate Std. Error z-value Pr(>|z|)
log(prbarr)  -0.5753943  0.8019932 -0.7175   0.4731
log(prbconv) -0.4230764  0.5018196 -0.8431   0.3992
log(prbpris) -0.2502194  0.2793986 -0.8956   0.3705
log(avgsen)   0.0090948  0.0489808  0.1857   0.8527
log(polpc)    0.6574104  0.8466656  0.7765   0.4375
log(density)  0.1395236  1.0210334  0.1366   0.8913
log(wcon)    -0.0287310  0.0535109 -0.5369   0.5913
log(wtuc)     0.0391296  0.0308542  1.2682   0.2047
log(wtrd)    -0.0177599  0.0453090 -0.3920   0.6951
log(wfir)    -0.0093412  0.0365471 -0.2556   0.7983
log(wser)     0.0185815  0.0388087  0.4788   0.6321
log(wmfg)    -0.2431858  0.4194999 -0.5797   0.5621
log(wfed)    -0.4512812  0.5270259 -0.8563   0.3918
log(wsta)    -0.0187117  0.2807606 -0.0666   0.9469
log(wloc)     0.2631882  0.3122909  0.8428   0.3994
log(pctymle)  0.3512984  1.0107677  0.3476   0.7282

Total Sum of Squares:    16.123
Residual Sum of Squares: 11.535
R-Squared:      0.39131
Adj. R-Squared: 0.26087
Chisq: 56.2016 on 16 DF, p-value: 2.2539e-06
> summary(fe_iv2) # logs as in data set by Baltagi -> results match exactly
Twoways effects Within Model
Instrumental variable estimation

Call:
plm(formula = form_iv2, data = Crime, effect = "twoways", model = "within", 
    inst.method = "baltagi")

Balanced Panel: n = 90, T = 7, N = 630

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-0.7209110 -0.0682207 -0.0041115  0.0759381  0.5661659 

Coefficients:
           Estimate Std. Error z-value Pr(>|z|)
lprbarr  -0.5755058  0.8021842 -0.7174   0.4731
lprbconv -0.4231446  0.5019375 -0.8430   0.3992
lprbpris -0.2502550  0.2794602 -0.8955   0.3705
lavgsen   0.0090987  0.0489879  0.1857   0.8527
lpolpc    0.6575270  0.8468673  0.7764   0.4375
ldensity  0.1394120  1.0212391  0.1365   0.8914
lwcon    -0.0287308  0.0535145 -0.5369   0.5914
lwtuc     0.0391292  0.0308568  1.2681   0.2048
lwtrd    -0.0177536  0.0453142 -0.3918   0.6952
lwfir    -0.0093443  0.0365519 -0.2556   0.7982
lwser     0.0185854  0.0388155  0.4788   0.6321
lwmfg    -0.2431684  0.4195485 -0.5796   0.5622
lwfed    -0.4513372  0.5271232 -0.8562   0.3919
lwsta    -0.0187458  0.2808182 -0.0668   0.9468
lwloc     0.2632585  0.3123945  0.8427   0.3994
lpctymle  0.3511166  1.0110334  0.3473   0.7284

Total Sum of Squares:    16.123
Residual Sum of Squares: 11.537
R-Squared:      0.3913
Adj. R-Squared: 0.26087
Chisq: 56.1934 on 16 DF, p-value: 2.2609e-06
> 
> # ## felm example
> # library(lfe)
> # form_felm <- log(crmrte) ~  log(prbconv) + log(prbpris) + log(avgsen) + log(density) + log(wcon) + log(wtuc) + log(wtrd) + log(wfir) + log(wser) + log(wmfg) + log(wfed) + log(wsta) + log(wloc) + log(pctymle)  |
> #   county + year |
> #   (log(prbarr) + log(polpc) ~ log(prbpris) + log(avgsen) + log(density) + log(wcon) + log(wtuc) + log(wtrd) + log(wfir) + log(wser) + log(wmfg) + log(wfed) + log(wsta) + log(wloc) + log(pctymle) + log(taxpc) + log(mix))
> # summary(felm(form_felm, data = Crime))
> 
> # replicates Table 7.1, column "BE2SLS"
> be_iv <- plm(form_iv, data = Crime, model = "between")
> summary(be_iv)
Oneway (individual) effect Between Model
Instrumental variable estimation
   (Balestra-Varadharajan-Krishnakumar's transformation)

Call:
plm(formula = form_iv, data = Crime, model = "between")

Balanced Panel: n = 90, T = 7, N = 630
Observations used in estimation: 90

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-0.5499406 -0.1041014  0.0029817  0.0986084  0.6020580 

Coefficients:
               Estimate Std. Error z-value  Pr(>|z|)    
(Intercept)   -1.977222   4.000782 -0.4942  0.621159    
log(prbarr)   -0.502946   0.240623 -2.0902  0.036601 *  
log(prbconv)  -0.524770   0.099948 -5.2504 1.517e-07 ***
log(prbpris)   0.187177   0.318292  0.5881  0.556487    
log(avgsen)   -0.227225   0.178509 -1.2729  0.203052    
log(polpc)     0.408439   0.192998  2.1163  0.034321 *  
log(density)   0.225624   0.102474  2.2018  0.027681 *  
log(wcon)      0.314005   0.259103  1.2119  0.225553    
log(wtuc)     -0.198943   0.197119 -1.0093  0.312854    
log(wtrd)      0.053559   0.296005  0.1809  0.856415    
log(wfir)      0.041707   0.305622  0.1365  0.891453    
log(wser)     -0.135428   0.173646 -0.7799  0.435446    
log(wmfg)     -0.042002   0.156266 -0.2688  0.788097    
log(wfed)      0.148024   0.325648  0.4546  0.649431    
log(wsta)     -0.203080   0.298153 -0.6811  0.495792    
log(wloc)      0.044440   0.494358  0.0899  0.928372    
log(pctymle)  -0.094720   0.191805 -0.4938  0.621423    
log(pctmin)    0.168902   0.052700  3.2049  0.001351 ** 
regionwest    -0.204816   0.113836 -1.7992  0.071982 .  
regioncentral -0.172932   0.066706 -2.5924  0.009530 ** 
smsayes       -0.080500   0.144232 -0.5581  0.576758    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    26.913
Residual Sum of Squares: 3.396
R-Squared:      0.87385
Adj. R-Squared: 0.83729
Chisq: 413.647 on 20 DF, p-value: < 2.22e-16
> 
> # not in table
> fd_iv <- plm(form_iv, data = Crime, model = "fd", effect = "individual")
> summary(fd_iv)
Oneway (individual) effect First-Difference Model
Instrumental variable estimation
   (Balestra-Varadharajan-Krishnakumar's transformation)

Call:
plm(formula = form_iv, data = Crime, effect = "individual", model = "fd")

Balanced Panel: n = 90, T = 7, N = 630
Observations used in estimation: 540

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-1.0255104 -0.0799101  0.0053594  0.0800347  0.9355716 

Coefficients:
               Estimate Std. Error z-value Pr(>|z|)
(Intercept)   0.0069945  0.1200615  0.0583   0.9535
log(prbarr)  -0.3657462  1.5603992 -0.2344   0.8147
log(prbconv) -0.2303887  0.9292399 -0.2479   0.8042
log(prbpris) -0.1751528  0.4564269 -0.3837   0.7012
log(avgsen)  -0.0109961  0.1067622 -0.1030   0.9180
log(polpc)    0.2537245  2.1624236  0.1173   0.9066
log(density) -0.1466853  2.4584727 -0.0597   0.9524
log(wcon)    -0.0368105  0.0605415 -0.6080   0.5432
log(wtuc)     0.0122918  0.0411881  0.2984   0.7654
log(wtrd)    -0.0388990  0.0501528 -0.7756   0.4380
log(wfir)     0.0013050  0.0373671  0.0349   0.9721
log(wser)     0.0164254  0.0152130  1.0797   0.2803
log(wmfg)    -0.2568435  0.3419870 -0.7510   0.4526
log(wfed)    -0.1409253  0.5886135 -0.2394   0.8108
log(wsta)     0.1249133  0.0970830  1.2867   0.1982
log(wloc)     0.0553071  0.6247338  0.0885   0.9295
log(pctymle) -0.0054946  1.3734037 -0.0040   0.9968

Total Sum of Squares:    22.197
Residual Sum of Squares: 14.057
R-Squared:      0.37134
Adj. R-Squared: 0.3521
Chisq: 46.0102 on 16 DF, p-value: 9.7009e-05
> 
> # replicates Table 7.1, column "EC2SLS"
> ## need to include time dummies!
> form_re_iv  <- log(crmrte) ~ log(prbarr) + log(prbconv) + log(prbpris) + log(avgsen) + log(polpc) + log(density) + log(wcon) + log(wtuc) + log(wtrd) + log(wfir) + log(wser) + log(wmfg) + log(wfed) + log(wsta) + log(wloc) + log(pctymle) + log(pctmin) + region + smsa + factor(year) | . -log(prbarr) - log(polpc) + log(taxpc) + log(mix)
> form_re_iv2 <- lcrmrte ~ lprbarr + lprbconv + lprbpris + lavgsen + lpolpc + ldensity + lwcon + lwtuc + lwtrd + lwfir + lwser + lwmfg + lwfed + lwsta + lwloc + lpctymle + lpctmin + region + smsa + factor(year) | . -lprbarr - lpolpc + ltaxpc + lmix
> re_iv  <- plm(form_re_iv,  data = Crime, model = "random", inst.method = "baltagi")
> re_iv2 <- plm(form_re_iv2, data = Crime, model = "random", inst.method = "baltagi")
> summary(re_iv)
Oneway (individual) effect Random Effect Model 
   (Swamy-Arora's transformation)
Instrumental variable estimation
   (Baltagi's transformation)

Call:
plm(formula = form_re_iv, data = Crime, model = "random", inst.method = "baltagi")

Balanced Panel: n = 90, T = 7, N = 630

Effects:
                  var std.dev share
idiosyncratic 0.02227 0.14923 0.326
individual    0.04604 0.21456 0.674
theta: 0.7458

Residuals:
     Min.   1st Qu.    Median   3rd Qu.      Max. 
-4.997164 -0.465637  0.027153  0.512779  3.917220 

Coefficients:
                 Estimate Std. Error z-value  Pr(>|z|)    
(Intercept)    -0.9536145  1.2839853 -0.7427  0.457664    
log(prbarr)    -0.4129201  0.0974056 -4.2392 2.243e-05 ***
log(prbconv)   -0.3228859  0.0535539 -6.0292 1.648e-09 ***
log(prbpris)   -0.1863204  0.0419391 -4.4426 8.886e-06 ***
log(avgsen)    -0.0101739  0.0270229 -0.3765  0.706551    
log(polpc)      0.4347568  0.0896981  4.8469 1.254e-06 ***
log(density)    0.4290337  0.0548511  7.8218 5.208e-15 ***
log(wcon)      -0.0074746  0.0395773 -0.1889  0.850202    
log(wtuc)       0.0454430  0.0197925  2.2960  0.021678 *  
log(wtrd)      -0.0081453  0.0413823 -0.1968  0.843960    
log(wfir)      -0.0036394  0.0289236 -0.1258  0.899867    
log(wser)       0.0056112  0.0201257  0.2788  0.780393    
log(wmfg)      -0.2041324  0.0804418 -2.5376  0.011160 *  
log(wfed)      -0.1635333  0.1594522 -1.0256  0.305083    
log(wsta)      -0.0540400  0.1056774 -0.5114  0.609094    
log(wloc)       0.1630405  0.1196368  1.3628  0.172947    
log(pctymle)   -0.1080968  0.1397015 -0.7738  0.439067    
log(pctmin)     0.1890388  0.0415013  4.5550 5.238e-06 ***
regionwest     -0.2268401  0.0995975 -2.2776  0.022752 *  
regioncentral  -0.1940408  0.0598277 -3.2433  0.001181 ** 
smsayes        -0.2251624  0.1156369 -1.9471  0.051517 .  
factor(year)82  0.0107457  0.0257968  0.4166  0.677006    
factor(year)83 -0.0837924  0.0307088 -2.7286  0.006360 ** 
factor(year)84 -0.1034973  0.0370886 -2.7905  0.005262 ** 
factor(year)85 -0.0956959  0.0494505 -1.9352  0.052968 .  
factor(year)86 -0.0688930  0.0595961 -1.1560  0.247681    
factor(year)87 -0.0314024  0.0705204 -0.4453  0.656106    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    30.168
Residual Sum of Squares: 544.47
R-Squared:      0.59845
Adj. R-Squared: 0.58114
Chisq: 575.685 on 26 DF, p-value: < 2.22e-16
> summary(re_iv2)
Oneway (individual) effect Random Effect Model 
   (Swamy-Arora's transformation)
Instrumental variable estimation
   (Baltagi's transformation)

Call:
plm(formula = form_re_iv2, data = Crime, model = "random", inst.method = "baltagi")

Balanced Panel: n = 90, T = 7, N = 630

Effects:
                  var std.dev share
idiosyncratic 0.02227 0.14924 0.326
individual    0.04604 0.21456 0.674
theta: 0.7457

Residuals:
     Min.   1st Qu.    Median   3rd Qu.      Max. 
-4.996927 -0.465655  0.027205  0.512780  3.917085 

Coefficients:
                 Estimate Std. Error z-value  Pr(>|z|)    
(Intercept)    -0.9538032  1.2839664 -0.7429  0.457568    
lprbarr        -0.4129261  0.0974020 -4.2394 2.241e-05 ***
lprbconv       -0.3228872  0.0535517 -6.0295 1.645e-09 ***
lprbpris       -0.1863195  0.0419382 -4.4427 8.883e-06 ***
lavgsen        -0.0101765  0.0270231 -0.3766  0.706481    
lpolpc          0.4347492  0.0896950  4.8470 1.254e-06 ***
ldensity        0.4290282  0.0548483  7.8221 5.196e-15 ***
lwcon          -0.0074751  0.0395775 -0.1889  0.850194    
lwtuc           0.0454450  0.0197926  2.2961  0.021673 *  
lwtrd          -0.0081412  0.0413828 -0.1967  0.844040    
lwfir          -0.0036395  0.0289238 -0.1258  0.899865    
lwser           0.0056098  0.0201259  0.2787  0.780447    
lwmfg          -0.2041398  0.0804393 -2.5378  0.011155 *  
lwfed          -0.1635108  0.1594496 -1.0255  0.305142    
lwsta          -0.0540503  0.1056769 -0.5115  0.609024    
lwloc           0.1630523  0.1196380  1.3629  0.172920    
lpctymle       -0.1081057  0.1396949 -0.7739  0.439007    
lpctmin         0.1890370  0.0414988  4.5552 5.233e-06 ***
regionwest     -0.2268433  0.0995913 -2.2777  0.022742 *  
regioncentral  -0.1940428  0.0598241 -3.2436  0.001180 ** 
smsayes        -0.2251539  0.1156302 -1.9472  0.051512 .  
factor(year)82  0.0107452  0.0257969  0.4165  0.677023    
factor(year)83 -0.0837944  0.0307088 -2.7287  0.006359 ** 
factor(year)84 -0.1034997  0.0370885 -2.7906  0.005261 ** 
factor(year)85 -0.0957017  0.0494502 -1.9353  0.052952 .  
factor(year)86 -0.0688982  0.0595956 -1.1561  0.247642    
factor(year)87 -0.0314071  0.0705197 -0.4454  0.656055    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    30.169
Residual Sum of Squares: 544.4
R-Squared:      0.59847
Adj. R-Squared: 0.58115
Chisq: 575.735 on 26 DF, p-value: < 2.22e-16
> 
> # replicates Baltagi (2013), p. 137/Baltagi (2021), p. 165 ("G2SLS"), table 7.3 (not in Table 7.1)
> re_iv_bvk  <- plm(form_re_iv,  data = Crime, model = "random", inst.method = "bvk")
> re_iv_bvk2 <- plm(form_re_iv2, data = Crime, model = "random", inst.method = "bvk")
> summary(re_iv_bvk)
Oneway (individual) effect Random Effect Model 
   (Swamy-Arora's transformation)
Instrumental variable estimation
   (Balestra-Varadharajan-Krishnakumar's transformation)

Call:
plm(formula = form_re_iv, data = Crime, model = "random", inst.method = "bvk")

Balanced Panel: n = 90, T = 7, N = 630

Effects:
                  var std.dev share
idiosyncratic 0.02227 0.14923 0.326
individual    0.04604 0.21456 0.674
theta: 0.7458

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-0.7485123 -0.0710015  0.0040742  0.0784401  0.4756493 

Coefficients:
                 Estimate Std. Error z-value  Pr(>|z|)    
(Intercept)    -0.4538241  1.7029840 -0.2665  0.789864    
log(prbarr)    -0.4141200  0.2210540 -1.8734  0.061015 .  
log(prbconv)   -0.3432383  0.1324679 -2.5911  0.009567 ** 
log(prbpris)   -0.1900437  0.0733420 -2.5912  0.009564 ** 
log(avgsen)    -0.0064374  0.0289406 -0.2224  0.823977    
log(polpc)      0.5049285  0.2277811  2.2167  0.026642 *  
log(density)    0.4343519  0.0711528  6.1045 1.031e-09 ***
log(wcon)      -0.0042963  0.0414225 -0.1037  0.917392    
log(wtuc)       0.0444572  0.0215449  2.0635  0.039068 *  
log(wtrd)      -0.0085626  0.0419822 -0.2040  0.838387    
log(wfir)      -0.0040302  0.0294565 -0.1368  0.891175    
log(wser)       0.0105604  0.0215822  0.4893  0.624620    
log(wmfg)      -0.2017917  0.0839423 -2.4039  0.016220 *  
log(wfed)      -0.2134634  0.2151074 -0.9924  0.321023    
log(wsta)      -0.0601083  0.1203146 -0.4996  0.617362    
log(wloc)       0.1835137  0.1396721  1.3139  0.188884    
log(pctymle)   -0.1458448  0.2268137 -0.6430  0.520214    
log(pctmin)     0.1948760  0.0459409  4.2419 2.217e-05 ***
regionwest     -0.2281780  0.1010317 -2.2585  0.023916 *  
regioncentral  -0.1987675  0.0607510 -3.2718  0.001068 ** 
smsayes        -0.2595423  0.1499780 -1.7305  0.083535 .  
factor(year)82  0.0132140  0.0299923  0.4406  0.659518    
factor(year)83 -0.0847676  0.0320008 -2.6489  0.008075 ** 
factor(year)84 -0.1062004  0.0387893 -2.7379  0.006184 ** 
factor(year)85 -0.0977398  0.0511685 -1.9102  0.056113 .  
factor(year)86 -0.0719390  0.0605821 -1.1875  0.235045    
factor(year)87 -0.0396520  0.0758537 -0.5227  0.601153    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    30.168
Residual Sum of Squares: 12.418
R-Squared:      0.59228
Adj. R-Squared: 0.5747
Chisq: 542.435 on 26 DF, p-value: < 2.22e-16
> summary(re_iv_bvk2)
Oneway (individual) effect Random Effect Model 
   (Swamy-Arora's transformation)
Instrumental variable estimation
   (Balestra-Varadharajan-Krishnakumar's transformation)

Call:
plm(formula = form_re_iv2, data = Crime, model = "random", inst.method = "bvk")

Balanced Panel: n = 90, T = 7, N = 630

Effects:
                  var std.dev share
idiosyncratic 0.02227 0.14924 0.326
individual    0.04604 0.21456 0.674
theta: 0.7457

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-0.7485357 -0.0709883  0.0040648  0.0784455  0.4756273 

Coefficients:
                 Estimate Std. Error z-value  Pr(>|z|)    
(Intercept)    -0.4538501  1.7029831 -0.2665  0.789852    
lprbarr        -0.4141383  0.2210496 -1.8735  0.060998 .  
lprbconv       -0.3432506  0.1324648 -2.5913  0.009563 ** 
lprbpris       -0.1900467  0.0733392 -2.5913  0.009560 ** 
lavgsen        -0.0064389  0.0289407 -0.2225  0.823935    
lpolpc          0.5049461  0.2277778  2.2168  0.026634 *  
ldensity        0.4343449  0.0711496  6.1047 1.030e-09 ***
lwcon          -0.0042958  0.0414226 -0.1037  0.917403    
lwtuc           0.0444589  0.0215448  2.0636  0.039060 *  
lwtrd          -0.0085579  0.0419829 -0.2038  0.838476    
lwfir          -0.0040305  0.0294569 -0.1368  0.891166    
lwser           0.0105602  0.0215823  0.4893  0.624630    
lwmfg          -0.2018020  0.0839373 -2.4042  0.016208 *  
lwfed          -0.2134579  0.2151046 -0.9923  0.321029    
lwsta          -0.0601232  0.1203149 -0.4997  0.617275    
lwloc           0.1835363  0.1396775  1.3140  0.188846    
lpctymle       -0.1458703  0.2268086 -0.6431  0.520131    
lpctmin         0.1948763  0.0459385  4.2421 2.214e-05 ***
regionwest     -0.2281821  0.1010260 -2.2586  0.023905 *  
regioncentral  -0.1987703  0.0607475 -3.2721  0.001068 ** 
smsayes        -0.2595451  0.1499718 -1.7306  0.083518 .  
factor(year)82  0.0132147  0.0299924  0.4406  0.659500    
factor(year)83 -0.0847693  0.0320010 -2.6490  0.008074 ** 
factor(year)84 -0.1062027  0.0387893 -2.7379  0.006183 ** 
factor(year)85 -0.0977457  0.0511681 -1.9103  0.056097 .  
factor(year)86 -0.0719451  0.0605819 -1.1876  0.235004    
factor(year)87 -0.0396595  0.0758531 -0.5228  0.601081    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    30.169
Residual Sum of Squares: 12.419
R-Squared:      0.5923
Adj. R-Squared: 0.57472
Chisq: 542.478 on 26 DF, p-value: < 2.22e-16
> cor(plm:::fitted_exp.plm(re_iv_bvk2), re_iv_bvk2$model[ , 1])^2 # overall R^2 as per Stata
[1] 0.7724889
> 
> 
> 
> ## Hausman-Taylor estimator:
> ## replicates Baltagi (2005, 2013), table 7.4; Baltagi (2021), table 7.5
> # (chisq values in Baltagi (2021) are not those of the models but of Hausman test
> #  between the models! plm's summary replicates chisq values of the models as 
> #  given by Stata and printed in Baltagi (2021), tables 7.6, 7.7)
> #
> # Table 7.5 claims to replicate Baltagi/Khanti-Akom (1990), table II, but values
> # for all models but within are largely different (even the GLS case!), making
> # the book reproducible but not the paper (likely the paper is in error!).
> data("Wages", package = "plm")
> pWages <- pdata.frame(Wages, index = 595)
> 
> form_wage <- lwage ~ wks + south + smsa + married + exp + I(exp ^ 2) + 
+   bluecol + ind + union + sex + black + ed
> 
> form_wage_iv <- lwage ~ wks + south + smsa + married + exp + I(exp ^ 2) + 
+   bluecol + ind + union + sex + black + ed |
+   bluecol + south + smsa + ind + sex + black |
+   wks + married + union + exp + I(exp ^ 2)
> 
> gls <- plm(form_wage, data = pWages, model = "random")
> summary(gls)
Oneway (individual) effect Random Effect Model 
   (Swamy-Arora's transformation)

Call:
plm(formula = form_wage, data = pWages, model = "random")

Balanced Panel: n = 595, T = 7, N = 4165

Effects:
                  var std.dev share
idiosyncratic 0.02310 0.15199 0.251
individual    0.06899 0.26266 0.749
theta: 0.7863

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-2.0612918 -0.1146344  0.0073351  0.1227697  2.0972144 

Coefficients:
               Estimate  Std. Error  z-value  Pr(>|z|)    
(Intercept)  4.2637e+00  9.7716e-02  43.6332 < 2.2e-16 ***
wks          1.0347e-03  7.7337e-04   1.3379 0.1809396    
southyes    -1.6618e-02  2.6527e-02  -0.6265 0.5310184    
smsayes     -1.3823e-02  1.9993e-02  -0.6914 0.4893108    
marriedyes  -7.4628e-02  2.3005e-02  -3.2440 0.0011788 ** 
exp          8.2054e-02  2.8478e-03  28.8138 < 2.2e-16 ***
I(exp^2)    -8.0845e-04  6.2823e-05 -12.8686 < 2.2e-16 ***
bluecolyes  -5.0066e-02  1.6647e-02  -3.0076 0.0026336 ** 
ind          3.7441e-03  1.7262e-02   0.2169 0.8282830    
unionyes     6.3223e-02  1.7070e-02   3.7038 0.0002124 ***
sexfemale   -3.3921e-01  5.1303e-02  -6.6119 3.795e-11 ***
blackyes    -2.1028e-01  5.7989e-02  -3.6262 0.0002876 ***
ed           9.9659e-02  5.7475e-03  17.3395 < 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    270.16
Residual Sum of Squares: 164.79
R-Squared:      0.39002
Adj. R-Squared: 0.38825
Chisq: 2654.74 on 12 DF, p-value: < 2.22e-16
> 
> within <- plm(form_wage, data = pWages, model = "within")
> summary(within)
Oneway (individual) effect Within Model

Call:
plm(formula = form_wage, data = pWages, model = "within")

Balanced Panel: n = 595, T = 7, N = 4165

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-1.8122282 -0.0519417  0.0038855  0.0614706  1.9434306 

Coefficients:
              Estimate  Std. Error t-value  Pr(>|t|)    
wks         8.3595e-04  5.9967e-04  1.3940   0.16340    
southyes   -1.8612e-03  3.4299e-02 -0.0543   0.95673    
smsayes    -4.2469e-02  1.9428e-02 -2.1859   0.02889 *  
marriedyes -2.9726e-02  1.8984e-02 -1.5659   0.11747    
exp         1.1321e-01  2.4710e-03 45.8141 < 2.2e-16 ***
I(exp^2)   -4.1835e-04  5.4595e-05 -7.6629 2.329e-14 ***
bluecolyes -2.1476e-02  1.3784e-02 -1.5581   0.11930    
ind         1.9210e-02  1.5446e-02  1.2437   0.21370    
unionyes    3.2785e-02  1.4923e-02  2.1970   0.02809 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    240.65
Residual Sum of Squares: 82.267
R-Squared:      0.65815
Adj. R-Squared: 0.60026
F-statistic: 761.751 on 9 and 3561 DF, p-value: < 2.22e-16
> 
> ht <- plm(form_wage_iv,
+           data = pWages,
+           random.method = "ht", model = "random", inst.method = "baltagi")
> summary(ht)
Oneway (individual) effect Random Effect Model 
   (Hausman-Taylor's transformation)
Instrumental variable estimation
   (Baltagi's transformation)

Call:
plm(formula = form_wage_iv, data = pWages, model = "random", 
    random.method = "ht", inst.method = "baltagi")

Balanced Panel: n = 595, T = 7, N = 4165

Effects:
                  var std.dev share
idiosyncratic 0.02304 0.15180 0.025
individual    0.88699 0.94180 0.975
theta: 0.9392

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-12.643736  -0.466002   0.043285   0.524739  13.340263 

Coefficients:
               Estimate  Std. Error z-value  Pr(>|z|)    
(Intercept)  2.9127e+00  2.8365e-01 10.2687 < 2.2e-16 ***
wks          8.3740e-04  5.9973e-04  1.3963   0.16263    
southyes     7.4398e-03  3.1955e-02  0.2328   0.81590    
smsayes     -4.1833e-02  1.8958e-02 -2.2066   0.02734 *  
marriedyes  -2.9851e-02  1.8980e-02 -1.5728   0.11578    
exp          1.1313e-01  2.4710e-03 45.7851 < 2.2e-16 ***
I(exp^2)    -4.1886e-04  5.4598e-05 -7.6718 1.696e-14 ***
bluecolyes  -2.0705e-02  1.3781e-02 -1.5024   0.13299    
ind          1.3604e-02  1.5237e-02  0.8928   0.37196    
unionyes     3.2771e-02  1.4908e-02  2.1982   0.02794 *  
sexfemale   -1.3092e-01  1.2666e-01 -1.0337   0.30129    
blackyes    -2.8575e-01  1.5570e-01 -1.8352   0.06647 .  
ed           1.3794e-01  2.1248e-02  6.4919 8.474e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    243.04
Residual Sum of Squares: 4163.6
R-Squared:      0.60945
Adj. R-Squared: 0.60833
Chisq: 6891.87 on 12 DF, p-value: < 2.22e-16
> 
> am <- plm(form_wage_iv, 
+           data = pWages,
+           random.method = "ht", model = "random", inst.method = "am")
> summary(am)
Oneway (individual) effect Random Effect Model 
   (Hausman-Taylor's transformation)
Instrumental variable estimation
   (Amemiya-MaCurdy's transformation)

Call:
plm(formula = form_wage_iv, data = pWages, model = "random", 
    random.method = "ht", inst.method = "am")

Balanced Panel: n = 595, T = 7, N = 4165

Effects:
                  var std.dev share
idiosyncratic 0.02304 0.15180 0.025
individual    0.88699 0.94180 0.975
theta: 0.9392

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-12.643192  -0.464811   0.043216   0.523598  13.338789 

Coefficients:
               Estimate  Std. Error z-value  Pr(>|z|)    
(Intercept)  2.9273e+00  2.7513e-01 10.6399 < 2.2e-16 ***
wks          8.3806e-04  5.9945e-04  1.3980   0.16210    
southyes     7.2818e-03  3.1936e-02  0.2280   0.81964    
smsayes     -4.1951e-02  1.8947e-02 -2.2141   0.02682 *  
marriedyes  -3.0089e-02  1.8967e-02 -1.5864   0.11266    
exp          1.1297e-01  2.4688e-03 45.7584 < 2.2e-16 ***
I(exp^2)    -4.2140e-04  5.4554e-05 -7.7244 1.124e-14 ***
bluecolyes  -2.0850e-02  1.3765e-02 -1.5147   0.12986    
ind          1.3629e-02  1.5229e-02  0.8949   0.37082    
unionyes     3.2475e-02  1.4894e-02  2.1804   0.02922 *  
sexfemale   -1.3201e-01  1.2660e-01 -1.0427   0.29709    
blackyes    -2.8590e-01  1.5549e-01 -1.8388   0.06595 .  
ed           1.3720e-01  2.0570e-02  6.6703 2.553e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    243.04
Residual Sum of Squares: 4160.3
R-Squared:      0.60948
Adj. R-Squared: 0.60835
Chisq: 6879.2 on 12 DF, p-value: < 2.22e-16
> 
> bms <- plm(form_wage_iv,
+           data = pWages,
+           random.method = "ht", model = "random", inst.method = "bms")
> summary(bms)
Oneway (individual) effect Random Effect Model 
   (Hausman-Taylor's transformation)
Instrumental variable estimation
   (Breusch-Mizon-Schmidt's transformation)

Call:
plm(formula = form_wage_iv, data = pWages, model = "random", 
    random.method = "ht", inst.method = "bms")

Balanced Panel: n = 595, T = 7, N = 4165

Effects:
                  var std.dev share
idiosyncratic 0.02304 0.15180 0.025
individual    0.88699 0.94180 0.975
theta: 0.9392

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-12.790365  -0.448022   0.042648   0.506978  13.292638 

Coefficients:
               Estimate  Std. Error z-value  Pr(>|z|)    
(Intercept)  1.9794e+00  2.6724e-01  7.4071 1.291e-13 ***
wks          7.9537e-04  5.9850e-04  1.3289  0.183869    
southyes     1.4668e-02  3.1883e-02  0.4601  0.645478    
smsayes     -5.2042e-02  1.8911e-02 -2.7520  0.005923 ** 
marriedyes  -3.9262e-02  1.8925e-02 -2.0747  0.038017 *  
exp          1.0867e-01  2.4557e-03 44.2513 < 2.2e-16 ***
I(exp^2)    -4.9060e-04  5.4352e-05 -9.0265 < 2.2e-16 ***
bluecolyes  -1.5389e-02  1.3737e-02 -1.1203  0.262596    
ind          1.9024e-02  1.5202e-02  1.2514  0.210795    
unionyes     3.7855e-02  1.4864e-02  2.5467  0.010873 *  
sexfemale   -1.8027e-01  1.2639e-01 -1.4263  0.153769    
blackyes    -1.5636e-01  1.5506e-01 -1.0084  0.313276    
ed           2.2066e-01  1.9850e-02 11.1162 < 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    243.04
Residual Sum of Squares: 4147.6
R-Squared:      0.60686
Adj. R-Squared: 0.60572
Chisq: 6467.37 on 12 DF, p-value: < 2.22e-16
> 
> # texreg::screenreg(list(ht, am, bms))
> 
> phtest(within, ht) # 5.2577 -> match Baltagi (2021), p. 175 for statistic but

	Hausman Test

data:  form_wage
chisq = 5.2577, df = 9, p-value = 0.8113
alternative hypothesis: one model is inconsistent

>                    #           df are different (9 vs. 3), Baltagi explains why df = 3.
> 
> phtest(ht, am) # 14.66 -> close to Baltagi's 17.74 (df = 12 vs. 13)

	Hausman Test

data:  form_wage_iv
chisq = 14.666, df = 12, p-value = 0.2602
alternative hypothesis: one model is inconsistent

> 
> 
> 
> 
> ### IV estimators ##
> form_wage_iv2 <- lwage ~ wks + married + exp + I(exp ^ 2) + bluecol |
+                    wks + exp + bluecol |
+                    wks + married +  exp + I(exp ^ 2)
> 
> ## balanced one-way individual
> IVbvk <- plm(form_wage_iv2,
+           data = pWages,
+           model = "random", inst.method = "bvk")
> summary(IVbvk)
Oneway (individual) effect Random Effect Model 
   (Swamy-Arora's transformation)
Instrumental variable estimation
   (Balestra-Varadharajan-Krishnakumar's transformation)

Call:
plm(formula = form_wage_iv2, data = pWages, model = "random", 
    inst.method = "bvk")

Balanced Panel: n = 595, T = 7, N = 4165

Effects:
                  var std.dev share
idiosyncratic 0.02315 0.15215 0.189
individual    0.09928 0.31509 0.811
theta: 0.8205

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-1.9670577 -0.1180355  0.0091769  0.1192050  2.0936461 

Coefficients:
               Estimate  Std. Error  z-value  Pr(>|z|)    
(Intercept)  5.3917e+00  5.2313e-02 103.0662 < 2.2e-16 ***
wks          1.1115e-03  7.7209e-04   1.4397    0.1500    
marriedyes  -1.3964e-02  2.1789e-02  -0.6409    0.5216    
exp          8.6050e-02  2.9196e-03  29.4729 < 2.2e-16 ***
I(exp^2)    -7.9169e-04  6.4523e-05 -12.2700 < 2.2e-16 ***
bluecolyes  -1.1180e-01  1.5963e-02  -7.0034 2.498e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    261.48
Residual Sum of Squares: 163.12
R-Squared:      0.37618
Adj. R-Squared: 0.37543
Chisq: 2507.95 on 5 DF, p-value: < 2.22e-16
> 
> IVbalt <- plm(form_wage_iv2,
+           data = pWages,
+           model = "random", inst.method = "baltagi")
> summary(IVbalt)
Oneway (individual) effect Random Effect Model 
   (Swamy-Arora's transformation)
Instrumental variable estimation
   (Baltagi's transformation)

Call:
plm(formula = form_wage_iv2, data = pWages, model = "random", 
    inst.method = "baltagi")

Balanced Panel: n = 595, T = 7, N = 4165

Effects:
                  var std.dev share
idiosyncratic 0.02315 0.15215 0.189
individual    0.09928 0.31509 0.811
theta: 0.8205

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-12.909745  -0.785178   0.047664   0.784261  13.789006 

Coefficients:
               Estimate  Std. Error  z-value  Pr(>|z|)    
(Intercept)  5.4619e+00  5.3852e-02 101.4244 < 2.2e-16 ***
wks          1.1434e-03  7.7454e-04   1.4763    0.1399    
marriedyes  -1.1791e-01  2.4588e-02  -4.7954 1.623e-06 ***
exp          8.7309e-02  3.1570e-03  27.6556 < 2.2e-16 ***
I(exp^2)    -8.1720e-04  7.0594e-05 -11.5761 < 2.2e-16 ***
bluecolyes  -1.0980e-01  1.6010e-02  -6.8583 6.968e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    261.48
Residual Sum of Squares: 7085.3
R-Squared:      0.3728
Adj. R-Squared: 0.37204
Chisq: 2502.88 on 5 DF, p-value: < 2.22e-16
> 
> IVam <- plm(form_wage_iv2, 
+           data = pWages,
+           model = "random", inst.method = "am")
> summary(IVam)
Oneway (individual) effect Random Effect Model 
   (Swamy-Arora's transformation)
Instrumental variable estimation
   (Amemiya-MaCurdy's transformation)

Call:
plm(formula = form_wage_iv2, data = pWages, model = "random", 
    inst.method = "am")

Balanced Panel: n = 595, T = 7, N = 4165

Effects:
                  var std.dev share
idiosyncratic 0.02315 0.15215 0.189
individual    0.09928 0.31509 0.811
theta: 0.8205

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-12.910190  -0.782406   0.048668   0.783272  13.787161 

Coefficients:
               Estimate  Std. Error  z-value  Pr(>|z|)    
(Intercept)  5.4599e+00  5.3794e-02 101.4955 < 2.2e-16 ***
wks          1.1451e-03  7.7434e-04   1.4788    0.1392    
marriedyes  -1.1314e-01  2.4486e-02  -4.6206 3.826e-06 ***
exp          8.7077e-02  3.1494e-03  27.6490 < 2.2e-16 ***
I(exp^2)    -8.1187e-04  7.0401e-05 -11.5320 < 2.2e-16 ***
bluecolyes  -1.0993e-01  1.6006e-02  -6.8681 6.504e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    261.48
Residual Sum of Squares: 7081.8
R-Squared:      0.3731
Adj. R-Squared: 0.37235
Chisq: 2501.31 on 5 DF, p-value: < 2.22e-16
> 
> IVbms <- plm(form_wage_iv2,
+            data = pWages,
+            model = "random", inst.method = "bms")
> summary(IVbms)
Oneway (individual) effect Random Effect Model 
   (Swamy-Arora's transformation)
Instrumental variable estimation
   (Breusch-Mizon-Schmidt's transformation)

Call:
plm(formula = form_wage_iv2, data = pWages, model = "random", 
    inst.method = "bms")

Balanced Panel: n = 595, T = 7, N = 4165

Effects:
                  var std.dev share
idiosyncratic 0.02315 0.15215 0.189
individual    0.09928 0.31509 0.811
theta: 0.8205

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-12.910637  -0.781238   0.049022   0.783769  13.787656 

Coefficients:
               Estimate  Std. Error  z-value  Pr(>|z|)    
(Intercept)  5.4586e+00  5.3775e-02 101.5077 < 2.2e-16 ***
wks          1.1419e-03  7.7433e-04   1.4747    0.1403    
marriedyes  -1.1298e-01  2.4431e-02  -4.6244 3.757e-06 ***
exp          8.7249e-02  3.1468e-03  27.7266 < 2.2e-16 ***
I(exp^2)    -8.1597e-04  7.0335e-05 -11.6012 < 2.2e-16 ***
bluecolyes  -1.0990e-01  1.6006e-02  -6.8660 6.600e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    261.48
Residual Sum of Squares: 7081.8
R-Squared:      0.37311
Adj. R-Squared: 0.37235
Chisq: 2503.01 on 5 DF, p-value: < 2.22e-16
> 
> # texreg::screenreg(list("BVK" = IVbvk, "Baltagi" = IVbalt, "AM" = IVam, "BMS" = IVbms),
> #                  digits = 5)
> 
> ## unbalanced one-way individual
> 
> pWages_ubal <- pWages[-c(2:7, 79:82, 500:505), ]
> pdim(pWages_ubal)
Unbalanced Panel: n = 595, T = 1-7, N = 4149
> IVbvk_ubal <- plm(form_wage_iv2,
+              data = pWages_ubal,
+              model = "random", inst.method = "bvk")
> summary(IVbvk_ubal)
Oneway (individual) effect Random Effect Model 
   (Swamy-Arora's transformation)
Instrumental variable estimation
   (Balestra-Varadharajan-Krishnakumar's transformation)

Call:
plm(formula = form_wage_iv2, data = pWages_ubal, model = "random", 
    inst.method = "bvk")

Unbalanced Panel: n = 595, T = 1-7, N = 4149

Effects:
                  var std.dev share
idiosyncratic 0.02323 0.15243  0.19
individual    0.09893 0.31453  0.81
theta:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.5639  0.8198  0.8198  0.8196  0.8198  0.8198 

Residuals:
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-1.97e+00 -1.18e-01  9.15e-03 -9.80e-06  1.20e-01  2.09e+00 

Coefficients:
               Estimate  Std. Error  z-value  Pr(>|z|)    
(Intercept)  5.3954e+00  5.2425e-02 102.9162 < 2.2e-16 ***
wks          1.1191e-03  7.7476e-04   1.4445    0.1486    
marriedyes  -1.3685e-02  2.1830e-02  -0.6269    0.5308    
exp          8.5760e-02  2.9316e-03  29.2539 < 2.2e-16 ***
I(exp^2)    -7.8934e-04  6.4755e-05 -12.1898 < 2.2e-16 ***
bluecolyes  -1.1174e-01  1.6014e-02  -6.9771 3.012e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    265.29
Residual Sum of Squares: 163.35
R-Squared:      0.38425
Adj. R-Squared: 0.38351
Chisq: 2477.34 on 5 DF, p-value: < 2.22e-16
> 
> IVbalt_ubal <- plm(form_wage_iv2,
+               data = pWages_ubal,
+               model = "random", inst.method = "baltagi")
> summary(IVbalt_ubal)
Oneway (individual) effect Random Effect Model 
   (Swamy-Arora's transformation)
Instrumental variable estimation
   (Baltagi's transformation)

Call:
plm(formula = form_wage_iv2, data = pWages_ubal, model = "random", 
    inst.method = "baltagi")

Unbalanced Panel: n = 595, T = 1-7, N = 4149

Effects:
                  var std.dev share
idiosyncratic 0.02323 0.15243  0.19
individual    0.09893 0.31453  0.81
theta:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.5639  0.8198  0.8198  0.8196  0.8198  0.8198 

Residuals:
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-1.29e+01 -7.91e-01  4.70e-02 -3.52e-04  7.86e-01  1.38e+01 

Coefficients:
               Estimate  Std. Error  z-value  Pr(>|z|)    
(Intercept)  5.4676e+00  5.4011e-02 101.2297 < 2.2e-16 ***
wks          1.1427e-03  7.7735e-04   1.4700    0.1416    
marriedyes  -1.1874e-01  2.4650e-02  -4.8172 1.456e-06 ***
exp          8.6999e-02  3.1742e-03  27.4081 < 2.2e-16 ***
I(exp^2)    -8.1476e-04  7.0926e-05 -11.4874 < 2.2e-16 ***
bluecolyes  -1.0986e-01  1.6064e-02  -6.8389 7.982e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    265.29
Residual Sum of Squares: 7070.4
R-Squared:      0.38083
Adj. R-Squared: 0.38008
Chisq: 2468.11 on 5 DF, p-value: < 2.22e-16
> 
> IVam_ubal <- plm(form_wage_iv2, 
+             data = pWages_ubal,
+             model = "random", inst.method = "am")
> summary(IVam_ubal)
Oneway (individual) effect Random Effect Model 
   (Swamy-Arora's transformation)
Instrumental variable estimation
   (Amemiya-MaCurdy's transformation)

Call:
plm(formula = form_wage_iv2, data = pWages_ubal, model = "random", 
    inst.method = "am")

Unbalanced Panel: n = 595, T = 1-7, N = 4149

Effects:
                  var std.dev share
idiosyncratic 0.02323 0.15243  0.19
individual    0.09893 0.31453  0.81
theta:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.5639  0.8198  0.8198  0.8196  0.8198  0.8198 

Residuals:
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-12.88629  -0.78669   0.04950  -0.00012   0.78612  13.76269 

Coefficients:
               Estimate  Std. Error  z-value  Pr(>|z|)    
(Intercept)  5.4638e+00  5.3915e-02 101.3399 < 2.2e-16 ***
wks          1.1511e-03  7.7708e-04   1.4813    0.1385    
marriedyes  -1.1403e-01  2.4534e-02  -4.6479 3.354e-06 ***
exp          8.6894e-02  3.1630e-03  27.4723 < 2.2e-16 ***
I(exp^2)    -8.1196e-04  7.0668e-05 -11.4898 < 2.2e-16 ***
bluecolyes  -1.0982e-01  1.6058e-02  -6.8391 7.968e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    265.29
Residual Sum of Squares: 7066.9
R-Squared:      0.38113
Adj. R-Squared: 0.38038
Chisq: 2471.83 on 5 DF, p-value: < 2.22e-16
> 
> IVbms_ubal <- plm(form_wage_iv2,
+              data = pWages_ubal,
+              model = "random", inst.method = "bms")
> 
> 
> summary(IVbms_ubal)
Oneway (individual) effect Random Effect Model 
   (Swamy-Arora's transformation)
Instrumental variable estimation
   (Breusch-Mizon-Schmidt's transformation)

Call:
plm(formula = form_wage_iv2, data = pWages_ubal, model = "random", 
    inst.method = "bms")

Unbalanced Panel: n = 595, T = 1-7, N = 4149

Effects:
                  var std.dev share
idiosyncratic 0.02323 0.15243  0.19
individual    0.09893 0.31453  0.81
theta:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.5639  0.8198  0.8198  0.8196  0.8198  0.8198 

Residuals:
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-1.29e+01 -7.87e-01  4.98e-02 -1.21e-04  7.87e-01  1.38e+01 

Coefficients:
               Estimate  Std. Error  z-value  Pr(>|z|)    
(Intercept)  5.4625e+00  5.3896e-02 101.3525 < 2.2e-16 ***
wks          1.1479e-03  7.7707e-04   1.4772    0.1396    
marriedyes  -1.1384e-01  2.4478e-02  -4.6507 3.308e-06 ***
exp          8.7064e-02  3.1603e-03  27.5490 < 2.2e-16 ***
I(exp^2)    -8.1602e-04  7.0601e-05 -11.5582 < 2.2e-16 ***
bluecolyes  -1.0979e-01  1.6058e-02  -6.8371 8.079e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    265.29
Residual Sum of Squares: 7066.9
R-Squared:      0.38114
Adj. R-Squared: 0.38039
Chisq: 2473.5 on 5 DF, p-value: < 2.22e-16
> 
> # texreg::screenreg(list("BVK ui" = IVbvk_ubal, "Baltagi ui" = IVbalt_ubal, "AM ui" = IVam_ubal, "BMS ui" = IVbms_ubal),
> #                  digits = 5)
> 
> 
> ## balanced one-way time
> # gives identical results for "am" and "bms" results are identical to "baltagi",
> # likely because  function StarX is not symmetric in effect
> IVbvk_t <- plm(form_wage_iv2,
+              data = pWages,
+              model = "random", inst.method = "bvk", effect = "time")
> summary(IVbvk_t)
Oneway (time) effect Random Effect Model 
   (Swamy-Arora's transformation)
Instrumental variable estimation
   (Balestra-Varadharajan-Krishnakumar's transformation)

Call:
plm(formula = form_wage_iv2, data = pWages, effect = "time", 
    model = "random", inst.method = "bvk")

Balanced Panel: n = 595, T = 7, N = 4165

Effects:
                 var std.dev share
idiosyncratic 0.1271  0.3565     1
time          0.0000  0.0000     0
theta: 0

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-1.9957868 -0.2573738 -0.0061258  0.2677200  2.1611993 

Coefficients:
               Estimate  Std. Error z-value  Pr(>|z|)    
(Intercept)  6.0131e+00  6.0968e-02  98.629 < 2.2e-16 ***
wks          3.6313e-03  1.2032e-03   3.018  0.002545 ** 
marriedyes   3.1837e-01  1.6118e-02  19.753 < 2.2e-16 ***
exp          3.6882e-02  2.4393e-03  15.120 < 2.2e-16 ***
I(exp^2)    -6.4913e-04  5.3708e-05 -12.086 < 2.2e-16 ***
bluecolyes  -3.2165e-01  1.2368e-02 -26.007 < 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    886.9
Residual Sum of Squares: 654.8
R-Squared:      0.2617
Adj. R-Squared: 0.26081
Chisq: 1474.21 on 5 DF, p-value: < 2.22e-16
> 
> IVbalt_t <- plm(form_wage_iv2,
+               data = pWages,
+               model = "random", inst.method = "baltagi", effect = "time")
> summary(IVbalt_t)
Oneway (time) effect Random Effect Model 
   (Swamy-Arora's transformation)
Instrumental variable estimation
   (Baltagi's transformation)

Call:
plm(formula = form_wage_iv2, data = pWages, effect = "time", 
    model = "random", inst.method = "baltagi")

Balanced Panel: n = 595, T = 7, N = 4165

Effects:
                 var std.dev share
idiosyncratic 0.1271  0.3565     1
time          0.0000  0.0000     0
theta: 0

Residuals:
     Min.   1st Qu.    Median   3rd Qu.      Max. 
-5.598694 -0.721869 -0.017043  0.751016  6.062259 

Coefficients:
               Estimate  Std. Error  z-value  Pr(>|z|)    
(Intercept)  6.01329823  0.06096780  98.6307 < 2.2e-16 ***
wks          0.00363128  0.00120324   3.0179  0.002545 ** 
marriedyes   0.31849295  0.01611823  19.7598 < 2.2e-16 ***
exp          0.03685389  0.00243934  15.1081 < 2.2e-16 ***
I(exp^2)    -0.00064850  0.00005371 -12.0740 < 2.2e-16 ***
bluecolyes  -0.32165802  0.01236790 -26.0075 < 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    886.9
Residual Sum of Squares: 5152.8
R-Squared:      0.2617
Adj. R-Squared: 0.26081
Chisq: 1474.19 on 5 DF, p-value: < 2.22e-16
> 
> IVam_t <- plm(form_wage_iv2, 
+             data = pWages,
+             model = "random", inst.method = "am", effect = "time")
> summary(IVam_t)
Oneway (time) effect Random Effect Model 
   (Swamy-Arora's transformation)
Instrumental variable estimation
   (Amemiya-MaCurdy's transformation)

Call:
plm(formula = form_wage_iv2, data = pWages, effect = "time", 
    model = "random", inst.method = "am")

Balanced Panel: n = 595, T = 7, N = 4165

Effects:
                 var std.dev share
idiosyncratic 0.1271  0.3565     1
time          0.0000  0.0000     0
theta: 0

Residuals:
     Min.   1st Qu.    Median   3rd Qu.      Max. 
-5.598694 -0.721869 -0.017043  0.751016  6.062259 

Coefficients:
               Estimate  Std. Error  z-value  Pr(>|z|)    
(Intercept)  6.01329823  0.06096780  98.6307 < 2.2e-16 ***
wks          0.00363128  0.00120324   3.0179  0.002545 ** 
marriedyes   0.31849295  0.01611823  19.7598 < 2.2e-16 ***
exp          0.03685389  0.00243934  15.1081 < 2.2e-16 ***
I(exp^2)    -0.00064850  0.00005371 -12.0740 < 2.2e-16 ***
bluecolyes  -0.32165802  0.01236790 -26.0075 < 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    886.9
Residual Sum of Squares: 5152.8
R-Squared:      0.2617
Adj. R-Squared: 0.26081
Chisq: 1474.19 on 5 DF, p-value: < 2.22e-16
> 
> IVbms_t <- plm(form_wage_iv2,
+              data = pWages,
+              model = "random", inst.method = "bms", effect = "time")
> summary(IVbms_t)
Oneway (time) effect Random Effect Model 
   (Swamy-Arora's transformation)
Instrumental variable estimation
   (Breusch-Mizon-Schmidt's transformation)

Call:
plm(formula = form_wage_iv2, data = pWages, effect = "time", 
    model = "random", inst.method = "bms")

Balanced Panel: n = 595, T = 7, N = 4165

Effects:
                 var std.dev share
idiosyncratic 0.1271  0.3565     1
time          0.0000  0.0000     0
theta: 0

Residuals:
     Min.   1st Qu.    Median   3rd Qu.      Max. 
-5.598694 -0.721869 -0.017043  0.751016  6.062259 

Coefficients:
               Estimate  Std. Error  z-value  Pr(>|z|)    
(Intercept)  6.01329823  0.06096780  98.6307 < 2.2e-16 ***
wks          0.00363128  0.00120324   3.0179  0.002545 ** 
marriedyes   0.31849295  0.01611823  19.7598 < 2.2e-16 ***
exp          0.03685389  0.00243934  15.1081 < 2.2e-16 ***
I(exp^2)    -0.00064850  0.00005371 -12.0740 < 2.2e-16 ***
bluecolyes  -0.32165802  0.01236790 -26.0075 < 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    886.9
Residual Sum of Squares: 5152.8
R-Squared:      0.2617
Adj. R-Squared: 0.26081
Chisq: 1474.19 on 5 DF, p-value: < 2.22e-16
> 
> # texreg::screenreg(list("BVK t" = IVbvk_t, "Baltagi t" = IVbalt_t, "AM t" = IVam_t, "BMS t" = IVbms_t),
> #                  digits = 5)
> 
> ## unbalanced one-way time
> IVbvk_t_ubal <- plm(form_wage_iv2,
+               data = pWages_ubal,
+               model = "random", inst.method = "bvk", effect = "time")
> summary(IVbvk_t_ubal)
Oneway (time) effect Random Effect Model 
   (Swamy-Arora's transformation)
Instrumental variable estimation
   (Balestra-Varadharajan-Krishnakumar's transformation)

Call:
plm(formula = form_wage_iv2, data = pWages_ubal, effect = "time", 
    model = "random", inst.method = "bvk")

Unbalanced Panel: n = 595, T = 1-7, N = 4149

Effects:
                 var std.dev share
idiosyncratic 0.1267  0.3559     1
time          0.0000  0.0000     0
theta:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      0       0       0       0       0       0 

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-1.9960628 -0.2575742 -0.0060508  0.2675715  2.1579866 

Coefficients:
               Estimate  Std. Error  z-value Pr(>|z|)    
(Intercept)  6.0335e+00  6.1226e-02  98.5444   <2e-16 ***
wks          3.3238e-03  1.2072e-03   2.7533   0.0059 ** 
marriedyes   3.2084e-01  1.6130e-02  19.8905   <2e-16 ***
exp          3.6349e-02  2.4441e-03  14.8720   <2e-16 ***
I(exp^2)    -6.3990e-04  5.3793e-05 -11.8954   <2e-16 ***
bluecolyes  -3.2373e-01  1.2389e-02 -26.1299   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    883.99
Residual Sum of Squares: 652.02
R-Squared:      0.26241
Adj. R-Squared: 0.26152
Chisq: 1473.97 on 5 DF, p-value: < 2.22e-16
> 
> IVbalt_t_ubal <- plm(form_wage_iv2,
+                data = pWages_ubal,
+                model = "random", inst.method = "baltagi", effect = "time")
> summary(IVbalt_t_ubal)
Oneway (time) effect Random Effect Model 
   (Swamy-Arora's transformation)
Instrumental variable estimation
   (Baltagi's transformation)

Call:
plm(formula = form_wage_iv2, data = pWages_ubal, effect = "time", 
    model = "random", inst.method = "baltagi")

Unbalanced Panel: n = 595, T = 1-7, N = 4149

Effects:
                 var std.dev share
idiosyncratic 0.1267  0.3559     1
time          0.0000  0.0000     0
theta:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      0       0       0       0       0       0 

Residuals:
     Min.   1st Qu.    Median   3rd Qu.      Max. 
-5.608286 -0.723549 -0.016968  0.751478  6.062804 

Coefficients:
               Estimate  Std. Error  z-value  Pr(>|z|)    
(Intercept)  6.0336e+00  6.1226e-02  98.5463 < 2.2e-16 ***
wks          3.3236e-03  1.2072e-03   2.7532  0.005902 ** 
marriedyes   3.2096e-01  1.6130e-02  19.8980 < 2.2e-16 ***
exp          3.6323e-02  2.4442e-03  14.8609 < 2.2e-16 ***
I(exp^2)    -6.3932e-04  5.3795e-05 -11.8844 < 2.2e-16 ***
bluecolyes  -3.2374e-01  1.2389e-02 -26.1307 < 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    883.99
Residual Sum of Squares: 5147.1
R-Squared:      0.26241
Adj. R-Squared: 0.26152
Chisq: 1473.99 on 5 DF, p-value: < 2.22e-16
> 
> IVam_t_ubal <- plm(form_wage_iv2, 
+              data = pWages_ubal,
+              model = "random", inst.method = "am", effect = "time")
> summary(IVam_t_ubal)
Oneway (time) effect Random Effect Model 
   (Swamy-Arora's transformation)
Instrumental variable estimation
   (Amemiya-MaCurdy's transformation)

Call:
plm(formula = form_wage_iv2, data = pWages_ubal, effect = "time", 
    model = "random", inst.method = "am")

Unbalanced Panel: n = 595, T = 1-7, N = 4149

Effects:
                 var std.dev share
idiosyncratic 0.1267  0.3559     1
time          0.0000  0.0000     0
theta:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      0       0       0       0       0       0 

Residuals:
     Min.   1st Qu.    Median   3rd Qu.      Max. 
-5.608287 -0.723547 -0.016967  0.751478  6.062799 

Coefficients:
               Estimate  Std. Error  z-value  Pr(>|z|)    
(Intercept)  6.0336e+00  6.1226e-02  98.5463 < 2.2e-16 ***
wks          3.3236e-03  1.2072e-03   2.7532  0.005902 ** 
marriedyes   3.2096e-01  1.6130e-02  19.8980 < 2.2e-16 ***
exp          3.6323e-02  2.4442e-03  14.8607 < 2.2e-16 ***
I(exp^2)    -6.3931e-04  5.3795e-05 -11.8842 < 2.2e-16 ***
bluecolyes  -3.2374e-01  1.2389e-02 -26.1307 < 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    883.99
Residual Sum of Squares: 5147.1
R-Squared:      0.26241
Adj. R-Squared: 0.26152
Chisq: 1473.99 on 5 DF, p-value: < 2.22e-16
> 
> IVbms_t_ubal <- plm(form_wage_iv2,
+               data = pWages_ubal,
+               model = "random", inst.method = "bms", effect = "time")
> summary(IVbms_t_ubal)
Oneway (time) effect Random Effect Model 
   (Swamy-Arora's transformation)
Instrumental variable estimation
   (Breusch-Mizon-Schmidt's transformation)

Call:
plm(formula = form_wage_iv2, data = pWages_ubal, effect = "time", 
    model = "random", inst.method = "bms")

Unbalanced Panel: n = 595, T = 1-7, N = 4149

Effects:
                 var std.dev share
idiosyncratic 0.1267  0.3559     1
time          0.0000  0.0000     0
theta:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      0       0       0       0       0       0 

Residuals:
     Min.   1st Qu.    Median   3rd Qu.      Max. 
-5.608281 -0.723591 -0.017027  0.751556  6.062880 

Coefficients:
               Estimate  Std. Error  z-value  Pr(>|z|)    
(Intercept)  6.0335e+00  6.1226e-02  98.5452 < 2.2e-16 ***
wks          3.3233e-03  1.2072e-03   2.7529  0.005907 ** 
marriedyes   3.2099e-01  1.6130e-02  19.8997 < 2.2e-16 ***
exp          3.6332e-02  2.4442e-03  14.8648 < 2.2e-16 ***
I(exp^2)    -6.3952e-04  5.3794e-05 -11.8884 < 2.2e-16 ***
bluecolyes  -3.2374e-01  1.2389e-02 -26.1307 < 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    883.99
Residual Sum of Squares: 5147.1
R-Squared:      0.26241
Adj. R-Squared: 0.26152
Chisq: 1474.18 on 5 DF, p-value: < 2.22e-16
> 
> # texreg::screenreg(list("BVK tu" = IVbvk_t_ubal, "Baltagi tu" = IVbalt_t_ubal, "AM tu" = IVam_t_ubal, "BMS tu" = IVbms_t_ubal),
> #                  digits = 5)
> 
> 
> ### twoway RE estimation: currently prevented (error informatively)
> # IVbvktw <- plm(form_wage_iv2,
> #               data = pWages,
> #               model = "random", inst.method = "bvk", effect = "twoways")
> # summary(IVbvktw)
> #
> # IVbalttw <- plm(form_wage_iv2,
> #                data = pWages,
> #                model = "random", inst.method = "baltagi", effect = "twoways")
> # summary(IVbalttw)
> # 
> # IVamtw <- plm(form_wage_iv2,
> #              data = pWages,
> #              model = "random", inst.method = "am", effect = "twoways")
> # summary(IVamtw)
> # 
> # IVbmstw <- plm(form_wage_iv2,
> #               data = pWages,
> #               model = "random", inst.method = "bms", effect = "twoways")
> # summary(IVbmstw)
> # 
> # texreg::screenreg(list("BVK tw" = IVbvktw, "Baltagi tw" = IVbalttw, "AM tw" = IVamtw, "BMS tw" = IVbmstw),
> #                   digits = 5)
> 
> 
> 
> proc.time()
   user  system elapsed 
   6.92    0.39    7.46 
